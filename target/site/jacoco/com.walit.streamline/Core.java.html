<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Core.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">streamline</a> &gt; <a href="index.source.html" class="el_package">com.walit.streamline</a> &gt; <span class="el_source">Core.java</span></div><h1>Core.java</h1><pre class="source lang-java linenums">package com.walit.streamline;

import com.googlecode.lanterna.SGR;
import com.googlecode.lanterna.TerminalSize;
import com.googlecode.lanterna.TextColor;
import com.googlecode.lanterna.gui2.*;
import com.googlecode.lanterna.screen.TerminalScreen;
import com.googlecode.lanterna.terminal.DefaultTerminalFactory;
import com.googlecode.lanterna.terminal.Terminal;

import java.io.IOException;
import java.util.HashMap;

import com.walit.streamline.Debug.StreamLineMessages;

public class Core {

    private WindowBasedTextGUI textGUI;

    // Windows
    private BasicWindow mainMenu;
    private BasicWindow helpMenu;

    public TerminalScreen screen;

    private Terminal terminal;
    private TerminalSize terminalSize;

    public final HashMap&lt;Integer, Button&gt; buttons;
    public int buttonCount;
    public int buttonWidth;
    public int buttonHeight;

<span class="fc" id="L34">    public Core() {</span>
<span class="fc" id="L35">        this.buttons = new HashMap&lt;Integer, Button&gt;();</span>
<span class="fc" id="L36">        DefaultTerminalFactory terminalFactory = new DefaultTerminalFactory();</span>
        try {
<span class="fc" id="L38">            this.terminal = terminalFactory.createTerminal();</span>
<span class="fc" id="L39">            this.screen = new TerminalScreen(terminal);</span>
<span class="fc" id="L40">            this.terminalSize = screen.getTerminalSize();</span>
<span class="fc" id="L41">            this.buttonHeight = 2;</span>
<span class="fc" id="L42">            this.buttonWidth = terminalSize.getColumns() / 4;</span>
<span class="fc" id="L43">            this.textGUI = new MultiWindowTextGUI(screen);</span>
<span class="fc" id="L44">            this.mainMenu = createMainMenuWindow(textGUI);</span>
<span class="fc" id="L45">            this.helpMenu = createHelpMenu(textGUI);</span>
<span class="nc" id="L46">        } catch (IOException iE) {</span>
<span class="nc" id="L47">            System.err.println(StreamLineMessages.FatalError.getMessage());</span>
<span class="nc" id="L48">            System.exit(1);</span>
<span class="fc" id="L49">        }</span>
<span class="fc" id="L50">    }</span>

    public boolean start() {
        try {
<span class="nc" id="L54">            screen.startScreen();</span>
<span class="nc" id="L55">            runMainWindow();</span>
<span class="nc" id="L56">            screen.stopScreen();</span>
<span class="nc" id="L57">        } catch (IOException iE) {</span>
<span class="nc" id="L58">            System.err.println(StreamLineMessages.FatalError.getMessage());</span>
<span class="nc" id="L59">            System.exit(1);</span>
<span class="nc" id="L60">            return false;</span>
<span class="nc" id="L61">        }</span>
<span class="nc" id="L62">        return true;</span>
    }

    public static void main(String [] args) {
<span class="nc" id="L66">        Core streamline = new Core();</span>
<span class="nc bnc" id="L67" title="All 2 branches missed.">        if (!streamline.start()) {</span>
<span class="nc" id="L68">            System.err.println(StreamLineMessages.FatalError.getMessage());</span>
<span class="nc" id="L69">            System.exit(1);</span>
        }
<span class="nc" id="L71">        System.out.println(StreamLineMessages.Farewell.getMessage());</span>
<span class="nc" id="L72">        System.exit(0);</span>
<span class="nc" id="L73">    }</span>

    public Button createButton(String text, Runnable runner) {
<span class="nc" id="L76">        Button button = new Button(text, runner);</span>
<span class="nc" id="L77">        button.setPreferredSize(getSize(buttonWidth, buttonHeight));</span>
<span class="nc" id="L78">        return button;</span>
    }

    public TerminalSize getSize(int bWidth, int bHeight) {
<span class="fc" id="L82">        return new TerminalSize(bWidth, bHeight);</span>
    }

    // Create WindowFactory
    public BasicWindow createMainMenuWindow(WindowBasedTextGUI textGUI) {
<span class="fc" id="L87">        BasicWindow window = new BasicWindow(&quot;StreamLine Music Player&quot;);</span>

<span class="fc" id="L89">        window.setHints(java.util.Arrays.asList(Window.Hint.FULL_SCREEN));</span>

<span class="fc" id="L91">        Panel panel = new Panel();</span>
<span class="fc" id="L92">        panel.setLayoutManager(new GridLayout(1));</span>
<span class="fc" id="L93">        panel.setPreferredSize(new TerminalSize(40, 20));</span>
<span class="fc" id="L94">        panel.setFillColorOverride(TextColor.ANSI.BLACK);</span>

        // CREATE LABELS AND BUTTONS
<span class="fc" id="L97">        Label titleLabel = new Label(&quot;    Welcome to StreamLine    &quot;);</span>
<span class="fc" id="L98">        titleLabel.addStyle(SGR.BOLD);</span>

<span class="pc" id="L100">        Button searchButton= new Button(&quot;Search for a song&quot;, () -&gt; System.out.println(&quot;Playing song&quot;));</span>
<span class="fc" id="L101">        searchButton.setPreferredSize(getSize(buttonWidth, buttonHeight));</span>
<span class="fc" id="L102">        buttons.put(buttonCount++, searchButton);</span>

<span class="pc" id="L104">        Button likedButton = new Button(&quot;View liked music&quot;, () -&gt; System.out.println(&quot;Liked songs&quot;));</span>
<span class="fc" id="L105">        likedButton.setPreferredSize(getSize(buttonWidth, buttonHeight));</span>
<span class="fc" id="L106">        buttons.put(buttonCount++, likedButton);</span>

<span class="pc" id="L108">        Button playlistsButton = new Button(&quot;Playlists&quot;, () -&gt; System.out.println(&quot;Playlists&quot;));</span>
<span class="fc" id="L109">        playlistsButton.setPreferredSize(getSize(buttonWidth, buttonHeight));</span>
<span class="fc" id="L110">        buttons.put(buttonCount++, playlistsButton);</span>

<span class="pc" id="L112">        Button recentlyPlayedButton = new Button(&quot;Recently Played&quot;, () -&gt; System.out.println(&quot;Recently played&quot;));</span>
<span class="fc" id="L113">        recentlyPlayedButton.setPreferredSize(getSize(buttonWidth, buttonHeight));</span>
<span class="fc" id="L114">        buttons.put(buttonCount++, recentlyPlayedButton);</span>

<span class="pc" id="L116">        Button helpButton = new Button(&quot;Help&quot;, () -&gt; transitionToHelpMenu(textGUI));</span>
<span class="fc" id="L117">        helpButton.setPreferredSize(getSize(buttonWidth, buttonHeight));</span>
<span class="fc" id="L118">        buttons.put(buttonCount++, helpButton);</span>

<span class="fc" id="L120">        Button quitButton = new Button(&quot;Quit&quot;, window::close);</span>
<span class="fc" id="L121">        quitButton.setPreferredSize(getSize(buttonWidth, buttonHeight));</span>
<span class="fc" id="L122">        buttons.put(buttonCount++, quitButton);</span>

<span class="fc" id="L124">        panel.addComponent(generateNewSpace());</span>
<span class="fc" id="L125">        panel.addComponent(titleLabel);</span>
<span class="fc bfc" id="L126" title="All 2 branches covered.">        for (int i = 0; i &lt; buttonCount; i++) {</span>
<span class="fc" id="L127">            panel.addComponent(buttons.get(i));</span>
        }

<span class="fc" id="L130">        window.setComponent(panel);</span>
<span class="fc" id="L131">        return window;</span>
    }

    // Create WindowFactory
    public BasicWindow createHelpMenu(WindowBasedTextGUI textGUI) {
<span class="fc" id="L136">        BasicWindow window = new BasicWindow(&quot;StreamLine Help Menu&quot;);</span>

<span class="fc" id="L138">        window.setHints(java.util.Arrays.asList(Window.Hint.FULL_SCREEN));</span>

<span class="fc" id="L140">        Panel panel = new Panel();</span>
<span class="fc" id="L141">        panel.setLayoutManager(new GridLayout(1));</span>
<span class="fc" id="L142">        panel.setPreferredSize(new TerminalSize(40, 20));</span>
<span class="fc" id="L143">        panel.setFillColorOverride(TextColor.ANSI.BLACK);</span>

<span class="fc" id="L145">        panel.addComponent(generateNewSpace());</span>

<span class="fc" id="L147">        Label searchHelpLabel = new Label(&quot;Search help&quot;);</span>
<span class="fc" id="L148">        searchHelpLabel.setPreferredSize(getSize(buttonWidth, buttonHeight));</span>
<span class="fc" id="L149">        searchHelpLabel.addStyle(SGR.BOLD);</span>
<span class="fc" id="L150">        panel.addComponent(searchHelpLabel);</span>

<span class="fc" id="L152">        Label searchHelpInfo = new Label(StreamLineMessages.SearchInformation.getMessage());</span>
<span class="fc" id="L153">        searchHelpInfo.addStyle(SGR.BOLD);</span>
<span class="fc" id="L154">        panel.addComponent(searchHelpInfo);</span>

<span class="fc" id="L156">        panel.addComponent(generateNewSpace());</span>

<span class="fc" id="L158">        Label likedMusicLabel = new Label(&quot;Liked music help&quot;);</span>
<span class="fc" id="L159">        likedMusicLabel.setPreferredSize(getSize(buttonWidth, buttonHeight));</span>
<span class="fc" id="L160">        likedMusicLabel.addStyle(SGR.BOLD);</span>
<span class="fc" id="L161">        panel.addComponent(likedMusicLabel);</span>

<span class="fc" id="L163">        Label likedMusicInfo = new Label(StreamLineMessages.LikedMusicInformation.getMessage());</span>
<span class="fc" id="L164">        likedMusicInfo.addStyle(SGR.BOLD);</span>
<span class="fc" id="L165">        panel.addComponent(likedMusicInfo);</span>

<span class="fc" id="L167">        panel.addComponent(generateNewSpace());</span>
<span class="fc" id="L168">        panel.addComponent(generateNewSpace());</span>

<span class="fc" id="L170">        Button backButton = new Button(&quot;&lt;- Back&quot;, () -&gt; {</span>
<span class="nc" id="L171">            dropWindow(helpMenu);</span>
<span class="nc" id="L172">            runMainWindow();</span>
<span class="nc" id="L173">        });</span>
<span class="fc" id="L174">        backButton.setPreferredSize(getSize(buttonWidth, buttonHeight / 2));</span>
<span class="fc" id="L175">        panel.addComponent(backButton);</span>

<span class="fc" id="L177">        window.setComponent(panel);</span>
<span class="fc" id="L178">        return window;</span>
    }

    public EmptySpace generateNewSpace() {
<span class="fc" id="L182">        EmptySpace space = new EmptySpace();</span>
<span class="fc" id="L183">        space.setPreferredSize(getSize(buttonWidth, buttonHeight));</span>
<span class="fc" id="L184">        space.setVisible(false);</span>
<span class="fc" id="L185">        return space;</span>
    }

    public void runMainWindow() {
<span class="nc" id="L189">        mainMenu.setVisible(true);</span>
<span class="nc" id="L190">        java.util.Collection&lt;Window&gt; openWindows = textGUI.getWindows();</span>
<span class="nc bnc" id="L191" title="All 2 branches missed.">        if (!openWindows.contains(mainMenu)) {</span>
<span class="nc" id="L192">            textGUI.addWindowAndWait(mainMenu);</span>
        }
<span class="nc" id="L194">    }</span>

    public void transitionToHelpMenu(WindowBasedTextGUI textGUI) {
<span class="nc" id="L197">        mainMenu.setVisible(false);</span>
<span class="nc" id="L198">        java.util.Collection&lt;Window&gt; openWindows = textGUI.getWindows();</span>
<span class="nc bnc" id="L199" title="All 2 branches missed.">        if (!openWindows.contains(helpMenu)) {</span>
<span class="nc" id="L200">            textGUI.addWindowAndWait(helpMenu);</span>
        }
<span class="nc" id="L202">    }</span>

    public void dropWindow(BasicWindow window) {
<span class="nc" id="L205">        textGUI.removeWindow(window);</span>
<span class="nc" id="L206">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>